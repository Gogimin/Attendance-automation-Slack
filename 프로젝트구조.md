# ìŠ¬ë™ ì¶œì„ì²´í¬ ìë™í™” - í”„ë¡œì íŠ¸ êµ¬ì¡°

> ë¦¬íŒ©í† ë§ ì™„ë£Œì¼: 2025-11-06
>
> ëª¨ë†€ë¦¬ì‹ êµ¬ì¡° (1591ì¤„) â†’ ëª¨ë“ˆí™” Blueprint íŒ¨í„´ (520ì¤„ + ëª¨ë“ˆ)

---

## ğŸ“Š ë¦¬íŒ©í† ë§ ì„±ê³¼

| í•­ëª© | Before | After | ê°œì„ ìœ¨ |
|-----|--------|-------|--------|
| **app_flask.py** | 1591ì¤„ | 520ì¤„ | **67% ê°ì†Œ** |
| **Route ê´€ë¦¬** | 1ê°œ íŒŒì¼ì— 14ê°œ route | 5ê°œ Blueprintë¡œ ë¶„ë¦¬ | âœ… ëª¨ë“ˆí™” |
| **ë³´ì•ˆ** | ê²½ë¡œ íƒìƒ‰ ì·¨ì•½ì  ì¡´ì¬ | ë°©ì–´ ë¡œì§ ì ìš© | âœ… ê°•í™” |
| **ìœ ì§€ë³´ìˆ˜ì„±** | ë‚®ìŒ | ë†’ìŒ | âœ… ê°œì„  |

---

## ğŸ—‚ï¸ ì „ì²´ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
SLACK_CHECK/
â”‚
â”œâ”€â”€ app_flask.py                    # â­ Flask ë©”ì¸ ì§„ì…ì  (520ì¤„)
â”œâ”€â”€ app_flask_backup_20251106.py   # ë°±ì—… íŒŒì¼
â”œâ”€â”€ README.md                       # í”„ë¡œì íŠ¸ ì†Œê°œ
â”œâ”€â”€ í”„ë¡œì íŠ¸êµ¬ì¡°.md                # ì´ íŒŒì¼
â”œâ”€â”€ APIë¬¸ì„œ.md                      # API ì—”ë“œí¬ì¸íŠ¸ ëª…ì„¸
â”‚
â”œâ”€â”€ src/                            # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ routes/                     # ğŸ”· Blueprint ë¼ìš°íŠ¸ (NEW!)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ attendance_routes.py   # ì¶œì„ ì²´í¬ route
â”‚   â”‚   â”œâ”€â”€ assignment_routes.py   # ê³¼ì œ ì²´í¬ route
â”‚   â”‚   â”œâ”€â”€ workspace_routes.py    # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬ route (NEW)
â”‚   â”‚   â”œâ”€â”€ schedule_routes.py     # ìŠ¤ì¼€ì¤„ ê´€ë¦¬ route (NEW)
â”‚   â”‚   â””â”€â”€ thread_routes.py       # ìŠ¤ë ˆë“œ ê²€ìƒ‰ route (NEW)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                   # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ attendance_service.py
â”‚   â”‚   â””â”€â”€ assignment_service.py
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                      # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ common.py              # ê³µí†µ í•¨ìˆ˜
â”‚   â”‚   â”œâ”€â”€ workspace_helper.py    # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ í—¬í¼ (NEW)
â”‚   â”‚   â””â”€â”€ error_handler.py       # ì—ëŸ¬ í•¸ë“¤ëŸ¬ (NEW)
â”‚   â”‚
â”‚   â”œâ”€â”€ workspace_manager.py        # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë§¤ë‹ˆì €
â”‚   â”œâ”€â”€ slack_handler.py            # Slack API í•¸ë“¤ëŸ¬
â”‚   â”œâ”€â”€ sheets_handler.py           # Google Sheets API í•¸ë“¤ëŸ¬
â”‚   â”œâ”€â”€ parser.py                   # ì¶œì„ ëŒ“ê¸€ íŒŒì‹±
â”‚   â””â”€â”€ assignment_parser.py        # ê³¼ì œ ì œì¶œ íŒŒì‹±
â”‚
â”œâ”€â”€ templates/                      # HTML í…œí”Œë¦¿
â”‚   â””â”€â”€ index.html
â”‚
â”œâ”€â”€ static/                         # ì •ì  íŒŒì¼
â”‚   â”œâ”€â”€ css/
â”‚   â””â”€â”€ js/
â”‚
â””â”€â”€ workspaces/                     # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë°ì´í„°
    â”œâ”€â”€ workspace1/
    â”‚   â”œâ”€â”€ config.json
    â”‚   â”œâ”€â”€ credentials.json
    â”‚   â””â”€â”€ assignment_history.json
    â””â”€â”€ workspace2/
        â””â”€â”€ ...
```

---

## ğŸ”· í•µì‹¬ íŒŒì¼ ì„¤ëª…

### 1. `app_flask.py` (520ì¤„)
**ì—­í• :** Flask ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 

```python
# ì£¼ìš” êµ¬ì„±
â”œâ”€â”€ Flask ì•± ì´ˆê¸°í™” ë° ì„¤ì •
â”œâ”€â”€ Blueprint ë“±ë¡ (5ê°œ)
â”‚   â”œâ”€â”€ attendance_bp
â”‚   â”œâ”€â”€ assignment_bp
â”‚   â”œâ”€â”€ workspace_bp
â”‚   â”œâ”€â”€ schedule_bp
â”‚   â””â”€â”€ thread_bp
â”œâ”€â”€ í™ˆí˜ì´ì§€ route (/)
â”œâ”€â”€ ìŠ¤ì¼€ì¤„ëŸ¬ í•¨ìˆ˜ (APScheduler)
â”‚   â”œâ”€â”€ setup_scheduler()
â”‚   â”œâ”€â”€ create_attendance_thread_job()
â”‚   â”œâ”€â”€ check_attendance_job()
â”‚   â””â”€â”€ restart_scheduler()
â””â”€â”€ ë©”ì¸ ì‹¤í–‰ ë¸”ë¡
```

**ì‚­ì œëœ ì½”ë“œ:**
- âŒ 14ê°œì˜ API route í•¨ìˆ˜ (â†’ Blueprintë¡œ ì´ë™)
- âŒ ì¤‘ë³µëœ ë ˆê±°ì‹œ route (ì•½ 350ì¤„)

**ì¶”ê°€ëœ ì½”ë“œ:**
- âœ… Blueprint import ë° ë“±ë¡
- âœ… restart_scheduler í•¨ìˆ˜ ì£¼ì…

---

### 2. `src/routes/` - Blueprint ëª¨ë“ˆ

#### ğŸ“‚ `attendance_routes.py` (ê¸°ì¡´)
**ë‹´ë‹¹:** ì¶œì„ ì²´í¬ ê¸°ëŠ¥

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ê¸°ëŠ¥ |
|-----------|--------|------|
| `/api/run-attendance` | POST | ì¶œì„ ì²´í¬ ì‹¤í–‰ |

**ì˜ì¡´ì„±:**
- `AttendanceService` (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
- `SlackHandler` (Slack API)
- `SheetsHandler` (Google Sheets API)

---

#### ğŸ“‚ `assignment_routes.py` (ê¸°ì¡´)
**ë‹´ë‹¹:** ê³¼ì œ ì œì¶œ ì²´í¬ ê¸°ëŠ¥

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ê¸°ëŠ¥ |
|-----------|--------|------|
| `/api/run-assignment` | POST | ê³¼ì œ ì²´í¬ ì‹¤í–‰ |
| `/api/assignment-history/<workspace_name>` | GET | ê³¼ì œ ì²´í¬ ê¸°ë¡ ì¡°íšŒ |

**ì˜ì¡´ì„±:**
- `AssignmentService` (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

---

#### ğŸ“‚ `workspace_routes.py` â­ **NEW**
**ë‹´ë‹¹:** ì›Œí¬ìŠ¤í˜ì´ìŠ¤ CRUD ë° ë™ëª…ì´ì¸ ê´€ë¦¬

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ê¸°ëŠ¥ |
|-----------|--------|------|
| `/api/workspaces` | GET | ì „ì²´ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ëª©ë¡ ì¡°íšŒ |
| `/api/workspaces/add` | POST | ìƒˆ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì¶”ê°€ |
| `/api/workspaces/delete` | POST | ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì‚­ì œ |
| `/api/workspaces/edit/<workspace_name>` | POST | ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì •ë³´ ìˆ˜ì • |
| `/api/workspaces/info/<workspace_name>` | GET | ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ìƒì„¸ ì •ë³´ |
| `/api/duplicate-names/<workspace_name>` | GET | ë™ëª…ì´ì¸ ì •ë³´ ì¡°íšŒ |
| `/api/duplicate-names/<workspace_name>` | POST | ë™ëª…ì´ì¸ ì •ë³´ ì €ì¥ |

**ë³´ì•ˆ ê¸°ëŠ¥:**
```python
from src.utils.workspace_helper import validate_workspace_name, safe_path_join

# ê²½ë¡œ íƒìƒ‰ ê³µê²© ë°©ì–´
if not validate_workspace_name(workspace_name):
    return error_response("ìœ íš¨í•˜ì§€ ì•Šì€ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì´ë¦„")

# ì•ˆì „í•œ ê²½ë¡œ ì¡°í•©
workspace_folder = safe_path_join(base_path, workspace_name)
```

---

#### ğŸ“‚ `schedule_routes.py` â­ **NEW**
**ë‹´ë‹¹:** ìë™ ì¶œì„ ì²´í¬ ìŠ¤ì¼€ì¤„ ê´€ë¦¬

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ê¸°ëŠ¥ |
|-----------|--------|------|
| `/api/schedule/<workspace_name>` | GET | ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ìŠ¤ì¼€ì¤„ ì¡°íšŒ |
| `/api/schedules/all` | GET | ëª¨ë“  ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ìŠ¤ì¼€ì¤„ ì¡°íšŒ |
| `/api/schedule` | POST | ìŠ¤ì¼€ì¤„ ì €ì¥ |
| `/api/schedule/delete` | POST | ìŠ¤ì¼€ì¤„ ì‚­ì œ |
| `/api/schedule/toggle` | POST | ìŠ¤ì¼€ì¤„ í™œì„±í™”/ë¹„í™œì„±í™” |

**íŠ¹ë³„í•œ êµ¬ì¡° - í•¨ìˆ˜ ì£¼ì… íŒ¨í„´:**
```python
# schedule_routes.py
_restart_scheduler = None

def set_restart_scheduler(func):
    """app_flask.pyì˜ restart_schedulerë¥¼ ì£¼ì…ë°›ìŒ"""
    global _restart_scheduler
    _restart_scheduler = func

# app_flask.py
from src.routes.schedule_routes import set_restart_scheduler
set_restart_scheduler(restart_scheduler)
```

**ì´ìœ :** `restart_scheduler()`ëŠ” APScheduler ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ”ë°, ì´ëŠ” `app_flask.py`ì—ë§Œ ì¡´ì¬í•˜ë¯€ë¡œ ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´ ì‚¬ìš©

---

#### ğŸ“‚ `thread_routes.py` â­ **NEW**
**ë‹´ë‹¹:** ì¶œì„ ìŠ¤ë ˆë“œ ìë™ ê²€ìƒ‰

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ê¸°ëŠ¥ |
|-----------|--------|------|
| `/api/find-thread` | POST | ìµœì‹  ì¶œì„ ìŠ¤ë ˆë“œ ìë™ ê°ì§€ |

**ê¸°ëŠ¥:**
- Slack ì±„ë„ì—ì„œ "ì¶œì„" í‚¤ì›Œë“œê°€ í¬í•¨ëœ ìµœì‹  ë©”ì‹œì§€ ê²€ìƒ‰
- Thread TS, ë©”ì‹œì§€ ë‚´ìš©, ì‘ì„±ì ID ë°˜í™˜

---

### 3. `src/services/` - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

#### ğŸ“‚ `attendance_service.py`
**ì—­í• :** ì¶œì„ ì²´í¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

**ì£¼ìš” ë©”ì„œë“œ:**
```python
class AttendanceService:
    def run_attendance_check(...):
        """ì¶œì„ ì²´í¬ ì‹¤í–‰"""
        # 1. Slackì—ì„œ ëŒ“ê¸€ ìˆ˜ì§‘
        # 2. ì¶œì„ì íŒŒì‹±
        # 3. Google Sheets ì—…ë°ì´íŠ¸
        # 4. ê²°ê³¼ ë°˜í™˜

    def send_notifications(...):
        """ì•Œë¦¼ ì „ì†¡"""
        # 1. ìŠ¤ë ˆë“œ ëŒ“ê¸€ ì‘ì„±
        # 2. DM ì „ì†¡
```

---

#### ğŸ“‚ `assignment_service.py`
**ì—­í• :** ê³¼ì œ ì²´í¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

**ì£¼ìš” ë©”ì„œë“œ:**
```python
class AssignmentService:
    def run_assignment_check(...):
        """ê³¼ì œ ì²´í¬ ì‹¤í–‰"""
        # 1. Slackì—ì„œ ì œì¶œì ìˆ˜ì§‘
        # 2. Google Sheets ì—…ë°ì´íŠ¸

    def save_history(...):
        """ê¸°ë¡ ì €ì¥"""
        # assignment_history.jsonì— ì €ì¥

    def get_history(...):
        """ê¸°ë¡ ì¡°íšŒ"""
```

---

### 4. `src/utils/` - ìœ í‹¸ë¦¬í‹°

#### ğŸ“‚ `workspace_helper.py` â­ **NEW**
**ì—­í• :** ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê´€ë ¨ ë³´ì•ˆ ìœ í‹¸ë¦¬í‹°

```python
def validate_workspace_name(workspace_name: str) -> bool:
    """
    ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì´ë¦„ ê²€ì¦
    - ê²½ë¡œ íƒìƒ‰ ê³µê²© ë°©ì–´ (.., /, \, null byte)
    - ê¸¸ì´ ì œí•œ (ìµœëŒ€ 50ì)
    """
    if not workspace_name:
        return False
    if '..' in workspace_name or workspace_name.startswith('.'):
        return False
    if any(char in workspace_name for char in ['/', '\\', '\0']):
        return False
    if len(workspace_name) > 50:
        return False
    return True

def safe_path_join(base: Path, workspace_name: str) -> Path:
    """
    ì•ˆì „í•œ ê²½ë¡œ ì¡°í•©
    - ê²½ë¡œ ì´íƒˆ ê°ì§€
    """
    if not validate_workspace_name(workspace_name):
        raise ValueError(f"ìœ íš¨í•˜ì§€ ì•Šì€ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì´ë¦„: {workspace_name}")

    workspace_folder = (base / workspace_name).resolve()
    base_resolved = base.resolve()

    if not str(workspace_folder).startswith(str(base_resolved)):
        raise ValueError(f"ê²½ë¡œ ì´íƒˆ ê°ì§€: {workspace_folder}")

    return workspace_folder
```

---

#### ğŸ“‚ `error_handler.py` â­ **NEW**
**ì—­í• :** ì „ì—­ ì—ëŸ¬ í•¸ë“¤ë§

```python
def safe_error_response(func):
    """
    ì•ˆì „í•œ ì—ëŸ¬ ì‘ë‹µ ë°ì½”ë ˆì´í„°
    - í”„ë¡œë•ì…˜: ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ìˆ¨ê¹€
    - ê°œë°œ: ìƒì„¸ ì—ëŸ¬ í‘œì‹œ
    """
    @wraps(func)
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            logger.exception(f"API error in {func.__name__}: {str(e)}")

            if not current_app.debug:
                return jsonify({
                    'success': False,
                    'error': 'ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
                }), 500

            return jsonify({
                'success': False,
                'error': str(e),
                'traceback': traceback.format_exc()
            }), 500
    return wrapper

def register_error_handlers(app):
    """ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬ ë“±ë¡"""
    @app.errorhandler(404)
    def not_found(error):
        return jsonify({'error': 'Not Found'}), 404

    @app.errorhandler(500)
    def internal_error(error):
        return jsonify({'error': 'Internal Server Error'}), 500
```

---

#### ğŸ“‚ `common.py` (ê¸°ì¡´ utils.py)
**ì—­í• :** ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜

```python
def parse_slack_thread_link(link_or_ts: str) -> str:
    """Slack URLì„ Thread TSë¡œ ë³€í™˜"""

def column_letter_to_index(letter: str) -> int:
    """ì—´ ë¬¸ì(A-Z)ë¥¼ ì¸ë±ìŠ¤ë¡œ ë³€í™˜"""

def column_index_to_letter(index: int) -> str:
    """ì¸ë±ìŠ¤ë¥¼ ì—´ ë¬¸ìë¡œ ë³€í™˜"""

def get_next_column(current_column: str) -> str:
    """ë‹¤ìŒ ì—´ ê³„ì‚°"""
```

---

## ğŸ” ë³´ì•ˆ ê°œì„ ì‚¬í•­

### 1. ê²½ë¡œ íƒìƒ‰ ê³µê²© ë°©ì–´
**Before:**
```python
# ì·¨ì•½ì : ì‚¬ìš©ì ì…ë ¥ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
workspace_folder = Path('workspaces') / workspace_name
```

**After:**
```python
# ë°©ì–´: ê²€ì¦ í›„ ì•ˆì „í•œ ê²½ë¡œ ì¡°í•©
if not validate_workspace_name(workspace_name):
    return error_response("ìœ íš¨í•˜ì§€ ì•Šì€ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì´ë¦„")

workspace_folder = safe_path_join(base_path, workspace_name)
```

### 2. ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ ë°©ì§€
**Before:**
```python
# ì·¨ì•½ì : ëª¨ë“  ì—ëŸ¬ ìƒì„¸ ë…¸ì¶œ
except Exception as e:
    return jsonify({'error': str(e), 'traceback': traceback.format_exc()})
```

**After:**
```python
# ë°©ì–´: í”„ë¡œë•ì…˜ì—ì„œëŠ” ì¼ë°˜ ë©”ì‹œì§€ë§Œ ë°˜í™˜
@safe_error_response
def route_handler():
    # ê°œë°œ ëª¨ë“œ: ìƒì„¸ ì—ëŸ¬
    # í”„ë¡œë•ì…˜: "ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
```

### 3. Secret Key ê´€ë¦¬
```python
# í™˜ê²½ë³€ìˆ˜ ì‚¬ìš© + ìë™ ìƒì„±
app.secret_key = os.getenv('SECRET_KEY', secrets.token_hex(32))
```

### 4. ì„¸ì…˜ ì¿ í‚¤ ë³´ì•ˆ
```python
app.config['SESSION_COOKIE_HTTPONLY'] = True  # JS ì ‘ê·¼ ì°¨ë‹¨
app.config['SESSION_COOKIE_SAMESITE'] = 'Lax'  # CSRF ë°©ì–´
```

---

## ğŸ”„ ì‹¤í–‰ íë¦„

### ì¶œì„ ì²´í¬ ì‹¤í–‰ íë¦„
```
[ì‚¬ìš©ì]
   â†“ POST /api/run-attendance
[attendance_routes.py]
   â†“ request ê²€ì¦
   â†“ workspace ë¡œë“œ
   â†“ SlackHandler, SheetsHandler ìƒì„±
   â†“
[AttendanceService.run_attendance_check()]
   â†“ 1. Slack ëŒ“ê¸€ ìˆ˜ì§‘
   â†“ 2. AttendanceParserë¡œ íŒŒì‹±
   â†“ 3. í•™ìƒ ëª…ë‹¨ê³¼ ë§¤ì¹­
   â†“ 4. Google Sheets ì—…ë°ì´íŠ¸
   â†“
[AttendanceService.send_notifications()]
   â†“ 1. ìŠ¤ë ˆë“œ ëŒ“ê¸€ ì‘ì„±
   â†“ 2. ì‘ì„±ìì—ê²Œ DM ì „ì†¡
   â†“
[ì‘ë‹µ]
   â†“ JSON ê²°ê³¼ ë°˜í™˜
```

### ìŠ¤ì¼€ì¤„ëŸ¬ ì‘ë™ íë¦„
```
[app_flask.py ì‹¤í–‰]
   â†“
[setup_scheduler()]
   â†“ 1. ëª¨ë“  ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë¡œë“œ
   â†“ 2. auto_schedule ì„¤ì • í™•ì¸
   â†“ 3. CronTrigger ìƒì„±
   â†“
[APScheduler]
   â†“ ë§¤ì£¼ ì„¤ì •ëœ ì‹œê°„ì— ì‹¤í–‰
   â†“
[create_attendance_thread_job()]
   â†“ ì¶œì„ ìŠ¤ë ˆë“œ ìë™ ìƒì„±
   â†“
[check_attendance_job()]
   â†“ ì¶œì„ ì²´í¬ ìë™ ì‹¤í–‰
```

---

## ğŸ¯ ì„¤ê³„ ì›ì¹™

### 1. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (SRP)
```
ê° BlueprintëŠ” í•˜ë‚˜ì˜ ë„ë©”ì¸ë§Œ ë‹´ë‹¹
- attendance_routes: ì¶œì„ ì²´í¬ë§Œ
- workspace_routes: ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬ë§Œ
- schedule_routes: ìŠ¤ì¼€ì¤„ ê´€ë¦¬ë§Œ
```

### 2. ê°œë°©-íì‡„ ì›ì¹™ (OCP)
```
ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”
- ìƒˆ Blueprint ì¶”ê°€ë§Œìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥
```

### 3. ì˜ì¡´ì„± ì£¼ì… (DI)
```python
# schedule_routesì— restart_scheduler ì£¼ì…
set_restart_scheduler(restart_scheduler)
```

### 4. ê´€ì‹¬ì‚¬ ë¶„ë¦¬ (SoC)
```
ê³„ì¸µ ë¶„ë¦¬:
- routes: HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
- services: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- utils: ê³µí†µ ìœ í‹¸ë¦¬í‹°
```

---

## ğŸ“ˆ í™•ì¥ ê°€ëŠ¥ì„±

### ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ
```python
# 1. ìƒˆ Blueprint ìƒì„±
# src/routes/report_routes.py
report_bp = Blueprint('report', __name__)

@report_bp.route('/api/reports/weekly', methods=['GET'])
def get_weekly_report():
    # ...

# 2. __init__.pyì— ì¶”ê°€
from .report_routes import report_bp
__all__ = [..., 'report_bp']

# 3. app_flask.pyì— ë“±ë¡
app.register_blueprint(report_bp)
```

### ìƒˆ ì„œë¹„ìŠ¤ ì¶”ê°€ ì‹œ
```python
# src/services/report_service.py
class ReportService:
    def generate_weekly_report(self):
        # ...
```

---

## ğŸ” íŒŒì¼ í¬ê¸° ë¹„êµ

```
Before:
app_flask.py: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1591ì¤„

After:
app_flask.py:       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 520ì¤„ (67% ê°ì†Œ)
attendance_routes:  â–ˆâ–ˆâ–ˆâ–ˆ 170ì¤„
assignment_routes:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 210ì¤„
workspace_routes:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 380ì¤„
schedule_routes:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 230ì¤„
thread_routes:      â–ˆâ–ˆ 60ì¤„
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

```bash
# 1. ê°€ìƒí™˜ê²½ í™œì„±í™”
conda activate auto

# 2. Flask ì•± ì‹¤í–‰
python app_flask.py

# 3. ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†
http://127.0.0.1:5000
```

---

## ğŸ“ ê²°ë¡ 

**ë¦¬íŒ©í† ë§ì„ í†µí•´ ë‹¬ì„±í•œ ê²ƒ:**
- âœ… ì½”ë“œ ê°€ë…ì„± í–¥ìƒ (1591ì¤„ â†’ 520ì¤„)
- âœ… ëª¨ë“ˆí™”ëœ êµ¬ì¡° (5ê°œ Blueprint)
- âœ… ë³´ì•ˆ ê°•í™” (ê²½ë¡œ íƒìƒ‰ ë°©ì–´, ì—ëŸ¬ ì²˜ë¦¬)
- âœ… ìœ ì§€ë³´ìˆ˜ì„± ê°œì„ 
- âœ… í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ
- âœ… í˜‘ì—… íš¨ìœ¨ì„± ì¦ê°€

**ê¸°ëŠ¥ì€ 100% ë™ì¼í•˜ê²Œ ìœ ì§€ë˜ë©°, êµ¬ì¡°ë§Œ ê°œì„ ë˜ì—ˆìŠµë‹ˆë‹¤.**
